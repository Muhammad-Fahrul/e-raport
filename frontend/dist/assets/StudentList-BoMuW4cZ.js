import{P as w,r as p,b as k,u as q,j as e,L as y,g as A}from"./index-X8ORgRL-.js";import{B as I}from"./ButtonIcon-DIV89OtH.js";import{a as C,b as O}from"./studentApiSlice-Cd2lNmtG.js";import{E as T}from"./Error-ClKIaVOv.js";const b=({studentId:d})=>{const a=k(),{student:n}=C("studentList",{selectFromResult:({data:i})=>({student:i==null?void 0:i.entities[d]})}),c=q(),r=()=>{a(`${n.username}`,{state:{from:c}})};let u=e.jsx("li",{className:"container-student",children:e.jsx("div",{className:"top",children:e.jsx("p",{className:"description",onClick:r,children:n.username})})});return e.jsx(e.Fragment,{children:u})};b.propTypes={studentId:w.string.isRequired};const B=p.memo(b),E=({setScreen:d})=>{var x;const[a,n]=p.useState(""),[c,r]=p.useState(""),[u,{isLoading:i,isError:f,error:m}]=O(),j=t=>{t.preventDefault(),(async()=>{try{const h=await u({username:a,password:c}).unwrap();d(!1),alert(`${h.message}`),n(""),r("")}catch{alert(`${a} gagal ditambahkan`)}})()};return e.jsxs(e.Fragment,{children:[y&&i,e.jsxs("form",{onSubmit:t=>j(t),className:"wrapper",children:[e.jsxs("div",{className:"title",style:{textAlign:"center"},children:[e.jsx("h1",{style:{fontSize:"1em"},children:"New Student"}),e.jsx("p",{style:{opacity:f?1:0,color:"red",fontSize:"0.6rem",width:"200px"},children:(x=m==null?void 0:m.data)==null?void 0:x.message})]}),e.jsxs("div",{className:"inputBox",children:[e.jsx("input",{name:"username",type:"text",required:"required",value:a,onChange:t=>n(t.target.value)}),e.jsx("span",{children:"Username"})]}),e.jsxs("div",{className:"inputBox",children:[e.jsx("input",{name:"password",type:"text",required:"required",value:c,onChange:t=>r(t.target.value)}),e.jsx("span",{children:"Password"})]}),e.jsx("button",{className:"enter",children:"Add"})]})]})};E.propTypes={setScreen:w.func.isRequired};const z=()=>{var g,h;const[d,a]=p.useState(!1),[n,c]=p.useState(""),r=A(),{data:u,isSuccess:i,isLoading:f,isError:m,error:j}=C("studentList",{pollingInterval:6e4,refetchOnFocus:!0,refetchOnMountOrArgChange:!0}),x=l=>{l.target.className==="container-student-new"&&a(!1)};let t;if(f)return e.jsx(y,{});if(i){const{ids:l,entities:S}=u;let N,v;if(r.isStudent){const s=(g=Object.values(S).find(o=>o.username.toLocaleLowerCase()===r.username.toLocaleLowerCase()))==null?void 0:g.id;v=Object.values(S).filter(o=>o.username.toLocaleLowerCase()!==r.username.toLocaleLowerCase()),N=l.filter(o=>o!==s)}else v=S,N=l;let L=Object.values(v).map(s=>{if(n.length){if(s.username.toLocaleLowerCase().includes(n.toLocaleLowerCase()))return s.id}else return s.id}).filter(s=>s!==void 0).map(s=>N.filter(o=>o===s)[0]);t=L.length?L.map(s=>e.jsx(B,{studentId:s},s)):e.jsx("h4",{children:"No Student"})}else if(m)return e.jsx(T,{message:(h=j.data)==null?void 0:h.message});return e.jsxs("div",{className:"container-students",children:[e.jsx("h3",{children:"STUDENTS"}),e.jsxs("form",{className:"form-search",children:[e.jsx("span",{className:"search-icon-container",children:e.jsx("i",{className:"fa-solid fa-magnifying-glass"})}),e.jsx("input",{type:"search",placeholder:"Search by Name",onChange:l=>c(l.target.value),value:n})]}),e.jsx("ul",{className:"students",children:t}),d&&e.jsx("div",{className:"container-student-new",onClick:x,children:e.jsx(E,{setScreen:a})}),r.isMentor&&e.jsx("div",{onClick:()=>a(!0),children:e.jsx(I,{text:"NEW",children:e.jsx("i",{className:"fa-solid fa-plus"})})})]})};export{z as default};
